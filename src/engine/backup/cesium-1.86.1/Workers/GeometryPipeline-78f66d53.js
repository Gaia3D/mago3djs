define(["exports","./AttributeCompression-0d03c199","./Matrix2-b06ef836","./RuntimeError-ffe03243","./when-229515d6","./ComponentDatatype-dc3af6a4","./Transforms-e254a706","./EncodedCartesian3-1c4d2319","./GeometryAttribute-b662d87a","./IndexDatatype-87b580b0","./IntersectionTests-8df35d37","./Plane-5d90414b"],(function(e,t,r,i,a,n,o,s,u,p,d,l){"use strict";var v=new r.Cartesian3,f=new r.Cartesian3,m=new r.Cartesian3;var y={calculateACMR:function(e){var t=(e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT)).indices,r=e.maximumIndex,n=a.defaultValue(e.cacheSize,24);if(!a.defined(t))throw new i.DeveloperError("indices is required.");var o=t.length;if(o<3||o%3!=0)throw new i.DeveloperError("indices length must be a multiple of three.");if(r<=0)throw new i.DeveloperError("maximumIndex must be greater than zero.");if(n<3)throw new i.DeveloperError("cacheSize must be greater than two.");if(!a.defined(r)){r=0;for(var s=0,u=t[s];s<o;)u>r&&(r=u),u=t[++s]}for(var p=[],d=0;d<r+1;d++)p[d]=0;for(var l=n+1,v=0;v<o;++v)l-p[t[v]]>n&&(p[t[v]]=l,++l);return(l-n+1)/(o/3)}};y.tipsify=function(e){var t,r=(e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT)).indices,n=e.maximumIndex,o=a.defaultValue(e.cacheSize,24);function s(e,r,i,a,n,o,s){for(var u,p=-1,d=-1,l=0;l<i.length;){var v=i[l];a[v].numLiveTriangles&&(u=0,n-a[v].timeStamp+2*a[v].numLiveTriangles<=r&&(u=n-a[v].timeStamp),(u>d||-1===d)&&(d=u,p=v)),++l}return-1===p?function(e,r,i,a){for(;r.length>=1;){var n=r[r.length-1];if(r.splice(r.length-1,1),e[n].numLiveTriangles>0)return n}for(;t<a;){if(e[t].numLiveTriangles>0)return++t-1;++t}return-1}(a,o,0,s):p}if(!a.defined(r))throw new i.DeveloperError("indices is required.");var u=r.length;if(u<3||u%3!=0)throw new i.DeveloperError("indices length must be a multiple of three.");if(n<=0)throw new i.DeveloperError("maximumIndex must be greater than zero.");if(o<3)throw new i.DeveloperError("cacheSize must be greater than two.");var p=0,d=0,l=r[d],v=u;if(a.defined(n))p=n+1;else{for(;d<v;)l>p&&(p=l),l=r[++d];if(-1===p)return 0;++p}var f,m=[];for(f=0;f<p;f++)m[f]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};d=0;for(var y=0;d<v;)m[r[d]].vertexTriangles.push(y),++m[r[d]].numLiveTriangles,m[r[d+1]].vertexTriangles.push(y),++m[r[d+1]].numLiveTriangles,m[r[d+2]].vertexTriangles.push(y),++m[r[d+2]].numLiveTriangles,++y,d+=3;var c=0,h=o+1;t=1;var C,b,w,g,T=[],A=[],E=0,D=[],x=u/3,P=[];for(f=0;f<x;f++)P[f]=!1;for(;-1!==c;){T=[],g=(b=m[c]).vertexTriangles.length;for(var I=0;I<g;++I)if(!P[y=b.vertexTriangles[I]]){P[y]=!0,d=y+y+y;for(var S=0;S<3;++S)w=r[d],T.push(w),A.push(w),D[E]=w,++E,--(C=m[w]).numLiveTriangles,h-C.timeStamp>o&&(C.timeStamp=h,++h),++d}c=s(0,o,T,m,h,A,p)}return D};var c={};function h(e,t,r,i,a){e[t++]=r,e[t++]=i,e[t++]=i,e[t++]=a,e[t++]=a,e[t]=r}function C(e){var t={};for(var r in e)if(e.hasOwnProperty(r)&&a.defined(e[r])&&a.defined(e[r].values)){var i=e[r];t[r]=new u.GeometryAttribute({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return t}function b(e,t,r){for(var i in t)if(t.hasOwnProperty(i)&&a.defined(t[i])&&a.defined(t[i].values))for(var n=t[i],o=0;o<n.componentsPerAttribute;++o)e[i].values.push(n.values[r*n.componentsPerAttribute+o])}c.toWireframe=function(e){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");var t=e.indices;if(a.defined(t)){switch(e.primitiveType){case u.PrimitiveType.TRIANGLES:e.indices=function(e){for(var t=e.length,r=t/3*6,i=p.IndexDatatype.createTypedArray(t,r),a=0,n=0;n<t;n+=3,a+=6)h(i,a,e[n],e[n+1],e[n+2]);return i}(t);break;case u.PrimitiveType.TRIANGLE_STRIP:e.indices=function(e){var t=e.length;if(t>=3){var r=6*(t-2),i=p.IndexDatatype.createTypedArray(t,r);h(i,0,e[0],e[1],e[2]);for(var a=6,n=3;n<t;++n,a+=6)h(i,a,e[n-1],e[n],e[n-2]);return i}return new Uint16Array}(t);break;case u.PrimitiveType.TRIANGLE_FAN:e.indices=function(e){if(e.length>0){for(var t=e.length-1,r=6*(t-1),i=p.IndexDatatype.createTypedArray(t,r),a=e[0],n=0,o=1;o<t;++o,n+=6)h(i,n,a,e[o],e[o+1]);return i}return new Uint16Array}(t);break;default:throw new i.DeveloperError("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=u.PrimitiveType.LINES}return e},c.createLineSegmentsForVectors=function(e,t,r){if(t=a.defaultValue(t,"normal"),!a.defined(e))throw new i.DeveloperError("geometry is required.");if(!a.defined(e.attributes.position))throw new i.DeveloperError("geometry.attributes.position is required.");if(!a.defined(e.attributes[t]))throw new i.DeveloperError("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+t+".");r=a.defaultValue(r,1e4);for(var s,p=e.attributes.position.values,d=e.attributes[t].values,l=p.length,v=new Float64Array(2*l),f=0,m=0;m<l;m+=3)v[f++]=p[m],v[f++]=p[m+1],v[f++]=p[m+2],v[f++]=p[m]+d[m]*r,v[f++]=p[m+1]+d[m+1]*r,v[f++]=p[m+2]+d[m+2]*r;var y=e.boundingSphere;return a.defined(y)&&(s=new o.BoundingSphere(y.center,y.radius+r)),new u.Geometry({attributes:{position:new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:v})},primitiveType:u.PrimitiveType.LINES,boundingSphere:s})},c.createAttributeLocations=function(e){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");var t,r=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,o={},s=0,u=r.length;for(t=0;t<u;++t){var p=r[t];a.defined(n[p])&&(o[p]=s++)}for(var d in n)n.hasOwnProperty(d)&&!a.defined(o[d])&&(o[d]=s++);return o},c.reorderForPreVertexCache=function(e){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");var t=u.Geometry.computeNumberOfVertices(e),r=e.indices;if(a.defined(r)){for(var o=new Int32Array(t),s=0;s<t;s++)o[s]=-1;for(var d,l=r,v=l.length,f=p.IndexDatatype.createTypedArray(t,v),m=0,y=0,c=0;m<v;)-1!==(d=o[l[m]])?f[y]=d:(o[d=l[m]]=c,f[y]=c,++c),++m,++y;e.indices=f;var h=e.attributes;for(var C in h)if(h.hasOwnProperty(C)&&a.defined(h[C])&&a.defined(h[C].values)){for(var b=h[C],w=b.values,g=0,T=b.componentsPerAttribute,A=n.ComponentDatatype.createTypedArray(b.componentDatatype,c*T);g<t;){var E=o[g];if(-1!==E)for(var D=0;D<T;D++)A[T*E+D]=w[T*g+D];++g}b.values=A}}return e},c.reorderForPostVertexCache=function(e,t){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");var r=e.indices;if(e.primitiveType===u.PrimitiveType.TRIANGLES&&a.defined(r)){for(var n=r.length,o=0,s=0;s<n;s++)r[s]>o&&(o=r[s]);e.indices=y.tipsify({indices:r,maximumIndex:o,cacheSize:t})}return e},c.fitToUnsignedShortIndices=function(e){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");if(a.defined(e.indices)&&e.primitiveType!==u.PrimitiveType.TRIANGLES&&e.primitiveType!==u.PrimitiveType.LINES&&e.primitiveType!==u.PrimitiveType.POINTS)throw new i.DeveloperError("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.");var t=[],r=u.Geometry.computeNumberOfVertices(e);if(a.defined(e.indices)&&r>=n.CesiumMath.SIXTY_FOUR_KILOBYTES){var o,s=[],p=[],d=0,l=C(e.attributes),v=e.indices,f=v.length;e.primitiveType===u.PrimitiveType.TRIANGLES?o=3:e.primitiveType===u.PrimitiveType.LINES?o=2:e.primitiveType===u.PrimitiveType.POINTS&&(o=1);for(var m=0;m<f;m+=o){for(var y=0;y<o;++y){var c=v[m+y],h=s[c];a.defined(h)||(h=d++,s[c]=h,b(l,e.attributes,c)),p.push(h)}d+o>=n.CesiumMath.SIXTY_FOUR_KILOBYTES&&(t.push(new u.Geometry({attributes:l,indices:p,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),s=[],p=[],d=0,l=C(e.attributes))}0!==p.length&&t.push(new u.Geometry({attributes:l,indices:p,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var w=new r.Cartesian3,g=new r.Cartographic;c.projectTo2D=function(e,t,s,p,d){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");if(!a.defined(t))throw new i.DeveloperError("attributeName is required.");if(!a.defined(s))throw new i.DeveloperError("attributeName3D is required.");if(!a.defined(p))throw new i.DeveloperError("attributeName2D is required.");if(!a.defined(e.attributes[t]))throw new i.DeveloperError("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==n.ComponentDatatype.DOUBLE)throw new i.DeveloperError("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var l=e.attributes[t],v=(d=a.defined(d)?d:new o.GeographicProjection).ellipsoid,f=l.values,m=new Float64Array(f.length),y=0,c=0;c<f.length;c+=3){var h=r.Cartesian3.fromArray(f,c,w),C=v.cartesianToCartographic(h,g);if(!a.defined(C))throw new i.DeveloperError("Could not project point ("+h.x+", "+h.y+", "+h.z+") to 2D.");var b=d.project(C,w);m[y++]=b.x,m[y++]=b.y,m[y++]=b.z}return e.attributes[s]=l,e.attributes[p]=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m}),delete e.attributes[t],e};var T={high:0,low:0};c.encodeAttribute=function(e,t,r,o){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");if(!a.defined(t))throw new i.DeveloperError("attributeName is required.");if(!a.defined(r))throw new i.DeveloperError("attributeHighName is required.");if(!a.defined(o))throw new i.DeveloperError("attributeLowName is required.");if(!a.defined(e.attributes[t]))throw new i.DeveloperError("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==n.ComponentDatatype.DOUBLE)throw new i.DeveloperError("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var p=e.attributes[t],d=p.values,l=d.length,v=new Float32Array(l),f=new Float32Array(l),m=0;m<l;++m)s.EncodedCartesian3.encode(d[m],T),v[m]=T.high,f[m]=T.low;var y=p.componentsPerAttribute;return e.attributes[r]=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:y,values:v}),e.attributes[o]=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:y,values:f}),delete e.attributes[t],e};var A=new r.Cartesian3;function E(e,t){if(a.defined(t))for(var i=t.values,n=i.length,o=0;o<n;o+=3)r.Cartesian3.unpack(i,o,A),r.Matrix4.multiplyByPoint(e,A,A),r.Cartesian3.pack(A,i,o)}function D(e,t){if(a.defined(t))for(var i=t.values,n=i.length,o=0;o<n;o+=3)r.Cartesian3.unpack(i,o,A),r.Matrix3.multiplyByVector(e,A,A),A=r.Cartesian3.normalize(A,A),r.Cartesian3.pack(A,i,o)}var x=new r.Matrix4,P=new r.Matrix3;c.transformToWorldCoordinates=function(e){if(!a.defined(e))throw new i.DeveloperError("instance is required.");var t=e.modelMatrix;if(r.Matrix4.equals(t,r.Matrix4.IDENTITY))return e;var n=e.geometry.attributes;E(t,n.position),E(t,n.prevPosition),E(t,n.nextPosition),(a.defined(n.normal)||a.defined(n.tangent)||a.defined(n.bitangent))&&(r.Matrix4.inverse(t,x),r.Matrix4.transpose(x,x),r.Matrix4.getMatrix3(x,P),D(P,n.normal),D(P,n.tangent),D(P,n.bitangent));var s=e.geometry.boundingSphere;return a.defined(s)&&(e.geometry.boundingSphere=o.BoundingSphere.transform(s,t,s)),e.modelMatrix=r.Matrix4.clone(r.Matrix4.IDENTITY),e};var I=new r.Cartesian3;function S(e,t){var s,d,l,v,f=e.length,m=e[0].modelMatrix,y=a.defined(e[0][t].indices),c=e[0][t].primitiveType;for(d=1;d<f;++d){if(!r.Matrix4.equals(e[d].modelMatrix,m))throw new i.DeveloperError("All instances must have the same modelMatrix.");if(a.defined(e[d][t].indices)!==y)throw new i.DeveloperError("All instance geometries must have an indices or not have one.");if(e[d][t].primitiveType!==c)throw new i.DeveloperError("All instance geometries must have the same primitiveType.")}var h,C,b,w,g=function(e,t){var r,i=e.length,o={},s=e[0][t].attributes;for(r in s)if(s.hasOwnProperty(r)&&a.defined(s[r])&&a.defined(s[r].values)){for(var p=s[r],d=p.values.length,l=!0,v=1;v<i;++v){var f=e[v][t].attributes[r];if(!a.defined(f)||p.componentDatatype!==f.componentDatatype||p.componentsPerAttribute!==f.componentsPerAttribute||p.normalize!==f.normalize){l=!1;break}d+=f.values.length}l&&(o[r]=new u.GeometryAttribute({componentDatatype:p.componentDatatype,componentsPerAttribute:p.componentsPerAttribute,normalize:p.normalize,values:n.ComponentDatatype.createTypedArray(p.componentDatatype,d)}))}return o}(e,t);for(s in g)if(g.hasOwnProperty(s))for(h=g[s].values,v=0,d=0;d<f;++d)for(b=(C=e[d][t].attributes[s].values).length,l=0;l<b;++l)h[v++]=C[l];if(y){var T=0;for(d=0;d<f;++d)T+=e[d][t].indices.length;var A=u.Geometry.computeNumberOfVertices(new u.Geometry({attributes:g,primitiveType:u.PrimitiveType.POINTS})),E=p.IndexDatatype.createTypedArray(A,T),D=0,x=0;for(d=0;d<f;++d){var P=e[d][t].indices,S=P.length;for(v=0;v<S;++v)E[D++]=x+P[v];x+=u.Geometry.computeNumberOfVertices(e[d][t])}w=E}var N,O=new r.Cartesian3,L=0;for(d=0;d<f;++d){if(N=e[d][t].boundingSphere,!a.defined(N)){O=void 0;break}r.Cartesian3.add(N.center,O,O)}if(a.defined(O))for(r.Cartesian3.divideByScalar(O,f,O),d=0;d<f;++d){N=e[d][t].boundingSphere;var z=r.Cartesian3.magnitude(r.Cartesian3.subtract(N.center,O,I))+N.radius;z>L&&(L=z)}return new u.Geometry({attributes:g,indices:w,primitiveType:c,boundingSphere:a.defined(O)?new o.BoundingSphere(O,L):void 0})}c.combineInstances=function(e){if(!a.defined(e)||e.length<1)throw new i.DeveloperError("instances is required and must have length greater than zero.");for(var t=[],r=[],n=e.length,o=0;o<n;++o){var s=e[o];a.defined(s.geometry)?t.push(s):a.defined(s.westHemisphereGeometry)&&a.defined(s.eastHemisphereGeometry)&&r.push(s)}var u=[];return t.length>0&&u.push(S(t,"geometry")),r.length>0&&(u.push(S(r,"westHemisphereGeometry")),u.push(S(r,"eastHemisphereGeometry"))),u};var N=new r.Cartesian3,O=new r.Cartesian3,L=new r.Cartesian3,z=new r.Cartesian3;c.computeNormal=function(e){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");if(!a.defined(e.attributes.position)||!a.defined(e.attributes.position.values))throw new i.DeveloperError("geometry.attributes.position.values is required.");if(!a.defined(e.indices))throw new i.DeveloperError("geometry.indices is required.");if(e.indices.length<2||e.indices.length%3!=0)throw new i.DeveloperError("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==u.PrimitiveType.TRIANGLES)throw new i.DeveloperError("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var t,o=e.indices,s=e.attributes,p=s.position.values,d=s.position.values.length/3,l=o.length,v=new Array(d),f=new Array(l/3),m=new Array(l);for(t=0;t<d;t++)v[t]={indexOffset:0,count:0,currentCount:0};var y=0;for(t=0;t<l;t+=3){var c=o[t],h=o[t+1],C=o[t+2],b=3*c,w=3*h,g=3*C;O.x=p[b],O.y=p[b+1],O.z=p[b+2],L.x=p[w],L.y=p[w+1],L.z=p[w+2],z.x=p[g],z.y=p[g+1],z.z=p[g+2],v[c].count++,v[h].count++,v[C].count++,r.Cartesian3.subtract(L,O,L),r.Cartesian3.subtract(z,O,z),f[y]=r.Cartesian3.cross(L,z,new r.Cartesian3),y++}var T,A=0;for(t=0;t<d;t++)v[t].indexOffset+=A,A+=v[t].count;for(y=0,t=0;t<l;t+=3){var E=(T=v[o[t]]).indexOffset+T.currentCount;m[E]=y,T.currentCount++,m[E=(T=v[o[t+1]]).indexOffset+T.currentCount]=y,T.currentCount++,m[E=(T=v[o[t+2]]).indexOffset+T.currentCount]=y,T.currentCount++,y++}var D=new Float32Array(3*d);for(t=0;t<d;t++){var x=3*t;if(T=v[t],r.Cartesian3.clone(r.Cartesian3.ZERO,N),T.count>0){for(y=0;y<T.count;y++)r.Cartesian3.add(N,f[m[T.indexOffset+y]],N);r.Cartesian3.equalsEpsilon(r.Cartesian3.ZERO,N,n.CesiumMath.EPSILON10)&&r.Cartesian3.clone(f[m[T.indexOffset]],N)}r.Cartesian3.equalsEpsilon(r.Cartesian3.ZERO,N,n.CesiumMath.EPSILON10)&&(N.z=1),r.Cartesian3.normalize(N,N),D[x]=N.x,D[x+1]=N.y,D[x+2]=N.z}return e.attributes.normal=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D}),e};var G=new r.Cartesian3,M=new r.Cartesian3,q=new r.Cartesian3;c.computeTangentAndBitangent=function(e){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");var t=e.attributes,o=e.indices;if(!a.defined(t.position)||!a.defined(t.position.values))throw new i.DeveloperError("geometry.attributes.position.values is required.");if(!a.defined(t.normal)||!a.defined(t.normal.values))throw new i.DeveloperError("geometry.attributes.normal.values is required.");if(!a.defined(t.st)||!a.defined(t.st.values))throw new i.DeveloperError("geometry.attributes.st.values is required.");if(!a.defined(o))throw new i.DeveloperError("geometry.indices is required.");if(o.length<2||o.length%3!=0)throw new i.DeveloperError("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==u.PrimitiveType.TRIANGLES)throw new i.DeveloperError("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var s,p,d,l,v=e.attributes.position.values,f=e.attributes.normal.values,m=e.attributes.st.values,y=e.attributes.position.values.length/3,c=o.length,h=new Array(3*y);for(s=0;s<h.length;s++)h[s]=0;for(s=0;s<c;s+=3){var C=o[s],b=o[s+1],w=o[s+2];d=3*b,l=3*w;var g=2*C,T=2*b,A=2*w,E=v[p=3*C],D=v[p+1],x=v[p+2],P=m[g],I=m[g+1],S=m[T+1]-I,N=m[A+1]-I,O=1/((m[T]-P)*N-(m[A]-P)*S),L=(N*(v[d]-E)-S*(v[l]-E))*O,z=(N*(v[d+1]-D)-S*(v[l+1]-D))*O,R=(N*(v[d+2]-x)-S*(v[l+2]-x))*O;h[p]+=L,h[p+1]+=z,h[p+2]+=R,h[d]+=L,h[d+1]+=z,h[d+2]+=R,h[l]+=L,h[l+1]+=z,h[l+2]+=R}var B=new Float32Array(3*y),V=new Float32Array(3*y);for(s=0;s<y;s++){d=(p=3*s)+1,l=p+2;var k=r.Cartesian3.fromArray(f,p,G),F=r.Cartesian3.fromArray(h,p,q),_=r.Cartesian3.dot(k,F);r.Cartesian3.multiplyByScalar(k,_,M),r.Cartesian3.normalize(r.Cartesian3.subtract(F,M,F),F),B[p]=F.x,B[d]=F.y,B[l]=F.z,r.Cartesian3.normalize(r.Cartesian3.cross(k,F,F),F),V[p]=F.x,V[d]=F.y,V[l]=F.z}return e.attributes.tangent=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:B}),e.attributes.bitangent=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:V}),e};var R=new r.Cartesian2,B=new r.Cartesian3,V=new r.Cartesian3,k=new r.Cartesian3,F=new r.Cartesian2;function _(e){switch(e.primitiveType){case u.PrimitiveType.TRIANGLE_FAN:return function(e){var t=u.Geometry.computeNumberOfVertices(e);if(t<3)throw new i.DeveloperError("The number of vertices must be at least three.");var r=p.IndexDatatype.createTypedArray(t,3*(t-2));r[0]=1,r[1]=0,r[2]=2;for(var a=3,n=3;n<t;++n)r[a++]=n-1,r[a++]=0,r[a++]=n;return e.indices=r,e.primitiveType=u.PrimitiveType.TRIANGLES,e}(e);case u.PrimitiveType.TRIANGLE_STRIP:return function(e){var t=u.Geometry.computeNumberOfVertices(e);if(t<3)throw new i.DeveloperError("The number of vertices must be at least 3.");var r=p.IndexDatatype.createTypedArray(t,3*(t-2));r[0]=0,r[1]=1,r[2]=2,t>3&&(r[3]=0,r[4]=2,r[5]=3);for(var a=6,n=3;n<t-1;n+=2)r[a++]=n,r[a++]=n-1,r[a++]=n+1,n+2<t&&(r[a++]=n,r[a++]=n+1,r[a++]=n+2);return e.indices=r,e.primitiveType=u.PrimitiveType.TRIANGLES,e}(e);case u.PrimitiveType.TRIANGLES:return function(e){if(a.defined(e.indices))return e;var t=u.Geometry.computeNumberOfVertices(e);if(t<3)throw new i.DeveloperError("The number of vertices must be at least three.");if(t%3!=0)throw new i.DeveloperError("The number of vertices must be a multiple of three.");for(var r=p.IndexDatatype.createTypedArray(t,t),n=0;n<t;++n)r[n]=n;return e.indices=r,e}(e);case u.PrimitiveType.LINE_STRIP:return function(e){var t=u.Geometry.computeNumberOfVertices(e);if(t<2)throw new i.DeveloperError("The number of vertices must be at least two.");var r=p.IndexDatatype.createTypedArray(t,2*(t-1));r[0]=0,r[1]=1;for(var a=2,n=2;n<t;++n)r[a++]=n-1,r[a++]=n;return e.indices=r,e.primitiveType=u.PrimitiveType.LINES,e}(e);case u.PrimitiveType.LINE_LOOP:return function(e){var t=u.Geometry.computeNumberOfVertices(e);if(t<2)throw new i.DeveloperError("The number of vertices must be at least two.");var r=p.IndexDatatype.createTypedArray(t,2*t);r[0]=0,r[1]=1;for(var a=2,n=2;n<t;++n)r[a++]=n-1,r[a++]=n;return r[a++]=t-1,r[a]=0,e.indices=r,e.primitiveType=u.PrimitiveType.LINES,e}(e);case u.PrimitiveType.LINES:return function(e){if(a.defined(e.indices))return e;var t=u.Geometry.computeNumberOfVertices(e);if(t<2)throw new i.DeveloperError("The number of vertices must be at least two.");if(t%2!=0)throw new i.DeveloperError("The number of vertices must be a multiple of 2.");for(var r=p.IndexDatatype.createTypedArray(t,t),n=0;n<t;++n)r[n]=n;return e.indices=r,e}(e)}return e}function U(e,t){Math.abs(e.y)<n.CesiumMath.EPSILON6&&(e.y=t?-n.CesiumMath.EPSILON6:n.CesiumMath.EPSILON6)}c.compressVertices=function(e){if(!a.defined(e))throw new i.DeveloperError("geometry is required.");var o,s,p=e.attributes.extrudeDirection;if(a.defined(p)){var d=p.values;s=d.length/3;var l=new Float32Array(2*s),v=0;for(o=0;o<s;++o)r.Cartesian3.fromArray(d,3*o,B),r.Cartesian3.equals(B,r.Cartesian3.ZERO)?v+=2:(F=t.AttributeCompression.octEncodeInRange(B,65535,F),l[v++]=F.x,l[v++]=F.y);return e.attributes.compressedAttributes=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:l}),delete e.attributes.extrudeDirection,e}var f=e.attributes.normal,m=e.attributes.st,y=a.defined(f),c=a.defined(m);if(!y&&!c)return e;var h,C,b,w,g=e.attributes.tangent,T=e.attributes.bitangent,A=a.defined(g),E=a.defined(T);y&&(h=f.values),c&&(C=m.values),A&&(b=g.values),E&&(w=T.values);var D=s=(y?h.length:C.length)/(y?3:2),x=c&&y?2:1;x+=A||E?1:0;var P=new Float32Array(D*=x),I=0;for(o=0;o<s;++o){c&&(r.Cartesian2.fromArray(C,2*o,R),P[I++]=t.AttributeCompression.compressTextureCoordinates(R));var S=3*o;y&&a.defined(b)&&a.defined(w)?(r.Cartesian3.fromArray(h,S,B),r.Cartesian3.fromArray(b,S,V),r.Cartesian3.fromArray(w,S,k),t.AttributeCompression.octPack(B,V,k,R),P[I++]=R.x,P[I++]=R.y):(y&&(r.Cartesian3.fromArray(h,S,B),P[I++]=t.AttributeCompression.octEncodeFloat(B)),A&&(r.Cartesian3.fromArray(b,S,B),P[I++]=t.AttributeCompression.octEncodeFloat(B)),E&&(r.Cartesian3.fromArray(w,S,B),P[I++]=t.AttributeCompression.octEncodeFloat(B)))}return e.attributes.compressedAttributes=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:x,values:P}),y&&delete e.attributes.normal,c&&delete e.attributes.st,E&&delete e.attributes.bitangent,A&&delete e.attributes.tangent,e};var Y=new r.Cartesian3;function Z(e,t,i,a){r.Cartesian3.add(e,r.Cartesian3.multiplyByScalar(r.Cartesian3.subtract(t,e,Y),e.y/(e.y-t.y),Y),i),r.Cartesian3.clone(i,a),U(i,!0),U(a,!1)}var H=new r.Cartesian3,W=new r.Cartesian3,X=new r.Cartesian3,j=new r.Cartesian3,J={positions:new Array(7),indices:new Array(9)};function K(e,t,r){if(!(e.x>=0||t.x>=0||r.x>=0)){!function(e,t,r){if(0!==e.y&&0!==t.y&&0!==r.y)return U(e,e.y<0),U(t,t.y<0),void U(r,r.y<0);var i=Math.abs(e.y),a=Math.abs(t.y),o=Math.abs(r.y),s=(i>a?i>o?n.CesiumMath.sign(e.y):n.CesiumMath.sign(r.y):a>o?n.CesiumMath.sign(t.y):n.CesiumMath.sign(r.y))<0;U(e,s),U(t,s),U(r,s)}(e,t,r);var i=e.y<0,a=t.y<0,o=r.y<0,s=0;s+=i?1:0,s+=a?1:0;var u=J.indices;1===(s+=o?1:0)?(u[1]=3,u[2]=4,u[5]=6,u[7]=6,u[8]=5,i?(Z(e,t,H,X),Z(e,r,W,j),u[0]=0,u[3]=1,u[4]=2,u[6]=1):a?(Z(t,r,H,X),Z(t,e,W,j),u[0]=1,u[3]=2,u[4]=0,u[6]=2):o&&(Z(r,e,H,X),Z(r,t,W,j),u[0]=2,u[3]=0,u[4]=1,u[6]=0)):2===s&&(u[2]=4,u[4]=4,u[5]=3,u[7]=5,u[8]=6,i?a?o||(Z(r,e,H,X),Z(r,t,W,j),u[0]=0,u[1]=1,u[3]=0,u[6]=2):(Z(t,r,H,X),Z(t,e,W,j),u[0]=2,u[1]=0,u[3]=2,u[6]=1):(Z(e,t,H,X),Z(e,r,W,j),u[0]=1,u[1]=2,u[3]=1,u[6]=0));var p=J.positions;return p[0]=e,p[1]=t,p[2]=r,p.length=3,1!==s&&2!==s||(p[3]=H,p[4]=W,p[5]=X,p[6]=j,p.length=7),J}}function Q(e,t){var r=e.attributes;if(0!==r.position.values.length){for(var i in r)if(r.hasOwnProperty(i)&&a.defined(r[i])&&a.defined(r[i].values)){var s=r[i];s.values=n.ComponentDatatype.createTypedArray(s.componentDatatype,s.values)}var d=u.Geometry.computeNumberOfVertices(e);return e.indices=p.IndexDatatype.createTypedArray(d,e.indices),t&&(e.boundingSphere=o.BoundingSphere.fromVertices(r.position.values)),e}}function $(e){var t=e.attributes,r={};for(var i in t)if(t.hasOwnProperty(i)&&a.defined(t[i])&&a.defined(t[i].values)){var n=t[i];r[i]=new u.GeometryAttribute({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}return new u.Geometry({attributes:r,indices:[],primitiveType:e.primitiveType})}function ee(e,t,r){var i=a.defined(e.geometry.boundingSphere);t=Q(t,i),r=Q(r,i),a.defined(r)&&!a.defined(t)?e.geometry=r:!a.defined(r)&&a.defined(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=r,e.geometry=void 0)}function te(e,t){var r=new e,i=new e,a=new e;return function(n,o,s,u,p,d,l,v){var f=e.fromArray(p,n*t,r),m=e.fromArray(p,o*t,i),y=e.fromArray(p,s*t,a);e.multiplyByScalar(f,u.x,f),e.multiplyByScalar(m,u.y,m),e.multiplyByScalar(y,u.z,y);var c=e.add(f,m,f);e.add(c,y,c),v&&e.normalize(c,c),e.pack(c,d,l*t)}}var re=te(r.Cartesian4,4),ie=te(r.Cartesian3,3),ae=te(r.Cartesian2,2),ne=new r.Cartesian3,oe=new r.Cartesian3,se=new r.Cartesian3,ue=new r.Cartesian3;function pe(e,t,o,s,u,p,d,l,y,c,h,C,b,w,g,T){if(a.defined(p)||a.defined(d)||a.defined(l)||a.defined(y)||a.defined(c)||0!==w){var A=function(e,t,o,s,u){var p,d,l,y,c,h,C,b;if(i.Check.defined("point",e),i.Check.defined("p0",t),i.Check.defined("p1",o),i.Check.defined("p2",s),a.defined(u)||(u=new r.Cartesian3),a.defined(t.z)){if(r.Cartesian3.equalsEpsilon(e,t,n.CesiumMath.EPSILON14))return r.Cartesian3.clone(r.Cartesian3.UNIT_X,u);if(r.Cartesian3.equalsEpsilon(e,o,n.CesiumMath.EPSILON14))return r.Cartesian3.clone(r.Cartesian3.UNIT_Y,u);if(r.Cartesian3.equalsEpsilon(e,s,n.CesiumMath.EPSILON14))return r.Cartesian3.clone(r.Cartesian3.UNIT_Z,u);p=r.Cartesian3.subtract(o,t,v),d=r.Cartesian3.subtract(s,t,f),l=r.Cartesian3.subtract(e,t,m),y=r.Cartesian3.dot(p,p),c=r.Cartesian3.dot(p,d),h=r.Cartesian3.dot(p,l),C=r.Cartesian3.dot(d,d),b=r.Cartesian3.dot(d,l)}else{if(r.Cartesian2.equalsEpsilon(e,t,n.CesiumMath.EPSILON14))return r.Cartesian3.clone(r.Cartesian3.UNIT_X,u);if(r.Cartesian2.equalsEpsilon(e,o,n.CesiumMath.EPSILON14))return r.Cartesian3.clone(r.Cartesian3.UNIT_Y,u);if(r.Cartesian2.equalsEpsilon(e,s,n.CesiumMath.EPSILON14))return r.Cartesian3.clone(r.Cartesian3.UNIT_Z,u);p=r.Cartesian2.subtract(o,t,v),d=r.Cartesian2.subtract(s,t,f),l=r.Cartesian2.subtract(e,t,m),y=r.Cartesian2.dot(p,p),c=r.Cartesian2.dot(p,d),h=r.Cartesian2.dot(p,l),C=r.Cartesian2.dot(d,d),b=r.Cartesian2.dot(d,l)}u.y=C*h-c*b,u.z=y*b-c*h;var w=y*C-c*c;return 0!==u.y&&(u.y/=w),0!==u.z&&(u.z/=w),u.x=1-u.y-u.z,u}(s,r.Cartesian3.fromArray(u,3*e,ne),r.Cartesian3.fromArray(u,3*t,oe),r.Cartesian3.fromArray(u,3*o,se),ue);if(a.defined(p)&&ie(e,t,o,A,p,C.normal.values,T,!0),a.defined(c)){var E,D=r.Cartesian3.fromArray(c,3*e,ne),x=r.Cartesian3.fromArray(c,3*t,oe),P=r.Cartesian3.fromArray(c,3*o,se);r.Cartesian3.multiplyByScalar(D,A.x,D),r.Cartesian3.multiplyByScalar(x,A.y,x),r.Cartesian3.multiplyByScalar(P,A.z,P),r.Cartesian3.equals(D,r.Cartesian3.ZERO)&&r.Cartesian3.equals(x,r.Cartesian3.ZERO)&&r.Cartesian3.equals(P,r.Cartesian3.ZERO)?((E=ne).x=0,E.y=0,E.z=0):(E=r.Cartesian3.add(D,x,D),r.Cartesian3.add(E,P,E),r.Cartesian3.normalize(E,E)),r.Cartesian3.pack(E,C.extrudeDirection.values,3*T)}if(a.defined(h)&&function(e,t,r,i,a,o,s){var u=a[e]*i.x,p=a[t]*i.y,d=a[r]*i.z;o[s]=u+p+d>n.CesiumMath.EPSILON6?1:0}(e,t,o,A,h,C.applyOffset.values,T),a.defined(d)&&ie(e,t,o,A,d,C.tangent.values,T,!0),a.defined(l)&&ie(e,t,o,A,l,C.bitangent.values,T,!0),a.defined(y)&&ae(e,t,o,A,y,C.st.values,T),w>0)for(var I=0;I<w;I++){var S=b[I];de(e,t,o,A,T,g[S],C[S])}}}function de(e,t,r,i,a,n,o){var s=n.componentsPerAttribute,u=n.values,p=o.values;switch(s){case 4:re(e,t,r,i,u,p,a,!1);break;case 3:ie(e,t,r,i,u,p,a,!1);break;case 2:ae(e,t,r,i,u,p,a,!1);break;default:p[a]=u[e]*i.x+u[t]*i.y+u[r]*i.z}}function le(e,t,r,i,a,n){var o=e.position.values.length/3;if(-1!==a){var s=i[a],u=r[s];return-1===u?(r[s]=o,e.position.values.push(n.x,n.y,n.z),t.push(o),o):(t.push(u),u)}return e.position.values.push(n.x,n.y,n.z),t.push(o),o}var ve={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function fe(e){var t=e.geometry,i=t.attributes,n=i.position.values,o=a.defined(i.normal)?i.normal.values:void 0,s=a.defined(i.bitangent)?i.bitangent.values:void 0,u=a.defined(i.tangent)?i.tangent.values:void 0,p=a.defined(i.st)?i.st.values:void 0,d=a.defined(i.extrudeDirection)?i.extrudeDirection.values:void 0,l=a.defined(i.applyOffset)?i.applyOffset.values:void 0,v=t.indices,f=[];for(var m in i)i.hasOwnProperty(m)&&!ve[m]&&a.defined(i[m])&&f.push(m);var y,c,h,C,b=f.length,w=$(t),g=$(t),T=[];T.length=n.length/3;var A=[];for(A.length=n.length/3,C=0;C<T.length;++C)T[C]=-1,A[C]=-1;var E=v.length;for(C=0;C<E;C+=3){var D=v[C],x=v[C+1],P=v[C+2],I=r.Cartesian3.fromArray(n,3*D),S=r.Cartesian3.fromArray(n,3*x),N=r.Cartesian3.fromArray(n,3*P),O=K(I,S,N);if(a.defined(O)&&O.positions.length>3)for(var L=O.positions,z=O.indices,G=z.length,M=0;M<G;++M){var q=z[M],R=L[q];R.y<0?(y=g.attributes,c=g.indices,h=T):(y=w.attributes,c=w.indices,h=A),pe(D,x,P,R,n,o,u,s,p,d,l,y,f,b,i,le(y,c,h,v,q<3?C+q:-1,R))}else a.defined(O)&&(I=O.positions[0],S=O.positions[1],N=O.positions[2]),I.y<0?(y=g.attributes,c=g.indices,h=T):(y=w.attributes,c=w.indices,h=A),pe(D,x,P,I,n,o,u,s,p,d,l,y,f,b,i,le(y,c,h,v,C,I)),pe(D,x,P,S,n,o,u,s,p,d,l,y,f,b,i,le(y,c,h,v,C+1,S)),pe(D,x,P,N,n,o,u,s,p,d,l,y,f,b,i,le(y,c,h,v,C+2,N))}ee(e,g,w)}var me=l.Plane.fromPointNormal(r.Cartesian3.ZERO,r.Cartesian3.UNIT_Y),ye=new r.Cartesian3,ce=new r.Cartesian3;function he(e,t,i,o,s,u,p){if(a.defined(p)){var d=r.Cartesian3.fromArray(o,3*e,ne);r.Cartesian3.equalsEpsilon(d,i,n.CesiumMath.EPSILON10)?u.applyOffset.values[s]=p[e]:u.applyOffset.values[s]=p[t]}}function Ce(e){var t,i=e.geometry,o=i.attributes,s=o.position.values,u=a.defined(o.applyOffset)?o.applyOffset.values:void 0,p=i.indices,l=$(i),v=$(i),f=p.length,m=[];m.length=s.length/3;var y=[];for(y.length=s.length/3,t=0;t<m.length;++t)m[t]=-1,y[t]=-1;for(t=0;t<f;t+=2){var c=p[t],h=p[t+1],C=r.Cartesian3.fromArray(s,3*c,ne),b=r.Cartesian3.fromArray(s,3*h,oe);Math.abs(C.y)<n.CesiumMath.EPSILON6&&(C.y<0?C.y=-n.CesiumMath.EPSILON6:C.y=n.CesiumMath.EPSILON6),Math.abs(b.y)<n.CesiumMath.EPSILON6&&(b.y<0?b.y=-n.CesiumMath.EPSILON6:b.y=n.CesiumMath.EPSILON6);var w=l.attributes,g=l.indices,T=y,A=v.attributes,E=v.indices,D=m,x=d.IntersectionTests.lineSegmentPlane(C,b,me,se);if(a.defined(x)){var P=r.Cartesian3.multiplyByScalar(r.Cartesian3.UNIT_Y,5*n.CesiumMath.EPSILON9,ye);C.y<0&&(r.Cartesian3.negate(P,P),w=v.attributes,g=v.indices,T=m,A=l.attributes,E=l.indices,D=y);var I=r.Cartesian3.add(x,P,ce);he(c,h,C,s,le(w,g,T,p,t,C),w,u),he(c,h,I,s,le(w,g,T,p,-1,I),w,u),r.Cartesian3.negate(P,P),r.Cartesian3.add(x,P,I),he(c,h,I,s,le(A,E,D,p,-1,I),A,u),he(c,h,b,s,le(A,E,D,p,t+1,b),A,u)}else{var S,N,O;C.y<0?(S=v.attributes,N=v.indices,O=m):(S=l.attributes,N=l.indices,O=y),he(c,h,C,s,le(S,N,O,p,t,C),S,u),he(c,h,b,s,le(S,N,O,p,t+1,b),S,u)}}ee(e,v,l)}var be=new r.Cartesian2,we=new r.Cartesian2,ge=new r.Cartesian3,Te=new r.Cartesian3,Ae=new r.Cartesian3,Ee=new r.Cartesian3,De=new r.Cartesian3,xe=new r.Cartesian3,Pe=new r.Cartesian4;function Ie(e){for(var t=e.attributes,i=t.position.values,a=t.prevPosition.values,n=t.nextPosition.values,o=i.length,s=0;s<o;s+=3){var u=r.Cartesian3.unpack(i,s,ge);if(!(u.x>0)){var p=r.Cartesian3.unpack(a,s,Te);(u.y<0&&p.y>0||u.y>0&&p.y<0)&&(s-3>0?(a[s]=i[s-3],a[s+1]=i[s-2],a[s+2]=i[s-1]):r.Cartesian3.pack(u,a,s));var d=r.Cartesian3.unpack(n,s,Ae);(u.y<0&&d.y>0||u.y>0&&d.y<0)&&(s+3<o?(n[s]=i[s+3],n[s+1]=i[s+4],n[s+2]=i[s+5]):r.Cartesian3.pack(u,n,s))}}}var Se=5*n.CesiumMath.EPSILON9,Ne=n.CesiumMath.EPSILON6;c.splitLongitude=function(e){if(!a.defined(e))throw new i.DeveloperError("instance is required.");var t=e.geometry,s=t.boundingSphere;if(a.defined(s)&&(s.center.x-s.radius>0||o.BoundingSphere.intersectPlane(s,l.Plane.ORIGIN_ZX_PLANE)!==o.Intersect.INTERSECTING))return e;if(t.geometryType!==u.GeometryType.NONE)switch(t.geometryType){case u.GeometryType.POLYLINES:!function(e){var t,i,o,s=e.geometry,u=s.attributes,p=u.position.values,l=u.prevPosition.values,v=u.nextPosition.values,f=u.expandAndWidth.values,m=a.defined(u.st)?u.st.values:void 0,y=a.defined(u.color)?u.color.values:void 0,c=$(s),h=$(s),C=!1,b=p.length/3;for(t=0;t<b;t+=4){var w=t,g=t+2,T=r.Cartesian3.fromArray(p,3*w,ge),A=r.Cartesian3.fromArray(p,3*g,Te);if(Math.abs(T.y)<Ne)for(T.y=Ne*(A.y<0?-1:1),p[3*t+1]=T.y,p[3*(t+1)+1]=T.y,i=3*w;i<3*w+12;i+=3)l[i]=p[3*t],l[i+1]=p[3*t+1],l[i+2]=p[3*t+2];if(Math.abs(A.y)<Ne)for(A.y=Ne*(T.y<0?-1:1),p[3*(t+2)+1]=A.y,p[3*(t+3)+1]=A.y,i=3*w;i<3*w+12;i+=3)v[i]=p[3*(t+2)],v[i+1]=p[3*(t+2)+1],v[i+2]=p[3*(t+2)+2];var E=c.attributes,D=c.indices,x=h.attributes,P=h.indices,I=d.IntersectionTests.lineSegmentPlane(T,A,me,Ee);if(a.defined(I)){C=!0;var S=r.Cartesian3.multiplyByScalar(r.Cartesian3.UNIT_Y,Se,De);T.y<0&&(r.Cartesian3.negate(S,S),E=h.attributes,D=h.indices,x=c.attributes,P=c.indices);var N=r.Cartesian3.add(I,S,xe);E.position.values.push(T.x,T.y,T.z,T.x,T.y,T.z),E.position.values.push(N.x,N.y,N.z),E.position.values.push(N.x,N.y,N.z),E.prevPosition.values.push(l[3*w],l[3*w+1],l[3*w+2]),E.prevPosition.values.push(l[3*w+3],l[3*w+4],l[3*w+5]),E.prevPosition.values.push(T.x,T.y,T.z,T.x,T.y,T.z),E.nextPosition.values.push(N.x,N.y,N.z),E.nextPosition.values.push(N.x,N.y,N.z),E.nextPosition.values.push(N.x,N.y,N.z),E.nextPosition.values.push(N.x,N.y,N.z),r.Cartesian3.negate(S,S),r.Cartesian3.add(I,S,N),x.position.values.push(N.x,N.y,N.z),x.position.values.push(N.x,N.y,N.z),x.position.values.push(A.x,A.y,A.z,A.x,A.y,A.z),x.prevPosition.values.push(N.x,N.y,N.z),x.prevPosition.values.push(N.x,N.y,N.z),x.prevPosition.values.push(N.x,N.y,N.z),x.prevPosition.values.push(N.x,N.y,N.z),x.nextPosition.values.push(A.x,A.y,A.z,A.x,A.y,A.z),x.nextPosition.values.push(v[3*g],v[3*g+1],v[3*g+2]),x.nextPosition.values.push(v[3*g+3],v[3*g+4],v[3*g+5]);var O=r.Cartesian2.fromArray(f,2*w,be),L=Math.abs(O.y);E.expandAndWidth.values.push(-1,L,1,L),E.expandAndWidth.values.push(-1,-L,1,-L),x.expandAndWidth.values.push(-1,L,1,L),x.expandAndWidth.values.push(-1,-L,1,-L);var z=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(I,T,Ae));if(z/=r.Cartesian3.magnitudeSquared(r.Cartesian3.subtract(A,T,Ae)),a.defined(y)){var G=r.Cartesian4.fromArray(y,4*w,Pe),M=r.Cartesian4.fromArray(y,4*g,Pe),q=n.CesiumMath.lerp(G.x,M.x,z),R=n.CesiumMath.lerp(G.y,M.y,z),B=n.CesiumMath.lerp(G.z,M.z,z),V=n.CesiumMath.lerp(G.w,M.w,z);for(i=4*w;i<4*w+8;++i)E.color.values.push(y[i]);for(E.color.values.push(q,R,B,V),E.color.values.push(q,R,B,V),x.color.values.push(q,R,B,V),x.color.values.push(q,R,B,V),i=4*g;i<4*g+8;++i)x.color.values.push(y[i])}if(a.defined(m)){var k=r.Cartesian2.fromArray(m,2*w,be),F=r.Cartesian2.fromArray(m,2*(t+3),we),_=n.CesiumMath.lerp(k.x,F.x,z);for(i=2*w;i<2*w+4;++i)E.st.values.push(m[i]);for(E.st.values.push(_,k.y),E.st.values.push(_,F.y),x.st.values.push(_,k.y),x.st.values.push(_,F.y),i=2*g;i<2*g+4;++i)x.st.values.push(m[i])}o=E.position.values.length/3-4,D.push(o,o+2,o+1),D.push(o+1,o+2,o+3),o=x.position.values.length/3-4,P.push(o,o+2,o+1),P.push(o+1,o+2,o+3)}else{var U,Y;for(T.y<0?(U=h.attributes,Y=h.indices):(U=c.attributes,Y=c.indices),U.position.values.push(T.x,T.y,T.z),U.position.values.push(T.x,T.y,T.z),U.position.values.push(A.x,A.y,A.z),U.position.values.push(A.x,A.y,A.z),i=3*t;i<3*t+12;++i)U.prevPosition.values.push(l[i]),U.nextPosition.values.push(v[i]);for(i=2*t;i<2*t+8;++i)U.expandAndWidth.values.push(f[i]),a.defined(m)&&U.st.values.push(m[i]);if(a.defined(y))for(i=4*t;i<4*t+16;++i)U.color.values.push(y[i]);o=U.position.values.length/3-4,Y.push(o,o+2,o+1),Y.push(o+1,o+2,o+3)}}C&&(Ie(h),Ie(c)),ee(e,h,c)}(e);break;case u.GeometryType.TRIANGLES:fe(e);break;case u.GeometryType.LINES:Ce(e)}else _(t),t.primitiveType===u.PrimitiveType.TRIANGLES?fe(e):t.primitiveType===u.PrimitiveType.LINES&&Ce(e);return e},e.GeometryPipeline=c}));
//# sourceMappingURL=GeometryPipeline-78f66d53.js.map
