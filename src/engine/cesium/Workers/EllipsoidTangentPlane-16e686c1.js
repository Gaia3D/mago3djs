define(["exports","./AxisAlignedBoundingBox-4e74fa8b","./Matrix2-b06ef836","./RuntimeError-ffe03243","./when-229515d6","./IntersectionTests-8df35d37","./Plane-5d90414b","./Transforms-e254a706"],(function(e,n,t,i,r,a,o,s){"use strict";var d=new t.Cartesian4;function l(e,n){if(i.Check.defined("origin",e),e=(n=r.defaultValue(n,t.Ellipsoid.WGS84)).scaleToGeodeticSurface(e),!r.defined(e))throw new i.DeveloperError("origin must not be at the center of the ellipsoid.");var a=s.Transforms.eastNorthUpToFixedFrame(e,n);this._ellipsoid=n,this._origin=e,this._xAxis=t.Cartesian3.fromCartesian4(t.Matrix4.getColumn(a,0,d)),this._yAxis=t.Cartesian3.fromCartesian4(t.Matrix4.getColumn(a,1,d));var l=t.Cartesian3.fromCartesian4(t.Matrix4.getColumn(a,2,d));this._plane=o.Plane.fromPointNormal(e,l)}Object.defineProperties(l.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var c=new n.AxisAlignedBoundingBox;l.fromPoints=function(e,t){return i.Check.defined("cartesians",e),new l(n.AxisAlignedBoundingBox.fromPoints(e,c).center,t)};var f=new a.Ray,h=new t.Cartesian3;l.prototype.projectPointOntoPlane=function(e,n){i.Check.defined("cartesian",e);var o=f;o.origin=e,t.Cartesian3.normalize(e,o.direction);var s=a.IntersectionTests.rayPlane(o,this._plane,h);if(r.defined(s)||(t.Cartesian3.negate(o.direction,o.direction),s=a.IntersectionTests.rayPlane(o,this._plane,h)),r.defined(s)){var d=t.Cartesian3.subtract(s,this._origin,s),l=t.Cartesian3.dot(this._xAxis,d),c=t.Cartesian3.dot(this._yAxis,d);return r.defined(n)?(n.x=l,n.y=c,n):new t.Cartesian2(l,c)}},l.prototype.projectPointsOntoPlane=function(e,n){i.Check.defined("cartesians",e),r.defined(n)||(n=[]);for(var t=0,a=e.length,o=0;o<a;o++){var s=this.projectPointOntoPlane(e[o],n[t]);r.defined(s)&&(n[t]=s,t++)}return n.length=t,n},l.prototype.projectPointToNearestOnPlane=function(e,n){i.Check.defined("cartesian",e),r.defined(n)||(n=new t.Cartesian2);var o=f;o.origin=e,t.Cartesian3.clone(this._plane.normal,o.direction);var s=a.IntersectionTests.rayPlane(o,this._plane,h);r.defined(s)||(t.Cartesian3.negate(o.direction,o.direction),s=a.IntersectionTests.rayPlane(o,this._plane,h));var d=t.Cartesian3.subtract(s,this._origin,s),l=t.Cartesian3.dot(this._xAxis,d),c=t.Cartesian3.dot(this._yAxis,d);return n.x=l,n.y=c,n},l.prototype.projectPointsToNearestOnPlane=function(e,n){i.Check.defined("cartesians",e),r.defined(n)||(n=[]);var t=e.length;n.length=t;for(var a=0;a<t;a++)n[a]=this.projectPointToNearestOnPlane(e[a],n[a]);return n};var p=new t.Cartesian3;l.prototype.projectPointOntoEllipsoid=function(e,n){i.Check.defined("cartesian",e),r.defined(n)||(n=new t.Cartesian3);var a=this._ellipsoid,o=this._origin,s=this._xAxis,d=this._yAxis,l=p;return t.Cartesian3.multiplyByScalar(s,e.x,l),n=t.Cartesian3.add(o,l,n),t.Cartesian3.multiplyByScalar(d,e.y,l),t.Cartesian3.add(n,l,n),a.scaleToGeocentricSurface(n,n),n},l.prototype.projectPointsOntoEllipsoid=function(e,n){i.Check.defined("cartesians",e);var t=e.length;r.defined(n)?n.length=t:n=new Array(t);for(var a=0;a<t;++a)n[a]=this.projectPointOntoEllipsoid(e[a],n[a]);return n},e.EllipsoidTangentPlane=l}));
//# sourceMappingURL=EllipsoidTangentPlane-16e686c1.js.map
