define(["exports","./Transforms-79117a7b","./Cartesian2-8646c5a1","./Check-24483042","./when-54335d57","./EllipsoidTangentPlane-325a8e68","./Math-d6182036","./Plane-13ae4b1b"],function(a,T,q,t,X,j,Z,G){"use strict";function v(a,t){this.center=q.Cartesian3.clone(X.defaultValue(a,q.Cartesian3.ZERO)),this.halfAxes=T.Matrix3.clone(X.defaultValue(t,T.Matrix3.ZERO))}v.packedLength=q.Cartesian3.packedLength+T.Matrix3.packedLength,v.pack=function(a,t,e){return e=X.defaultValue(e,0),q.Cartesian3.pack(a.center,t,e),T.Matrix3.pack(a.halfAxes,t,e+q.Cartesian3.packedLength),t},v.unpack=function(a,t,e){return t=X.defaultValue(t,0),X.defined(e)||(e=new v),q.Cartesian3.unpack(a,t,e.center),T.Matrix3.unpack(a,t+q.Cartesian3.packedLength,e.halfAxes),e};var R=new q.Cartesian3,I=new q.Cartesian3,E=new q.Cartesian3,L=new q.Cartesian3,z=new q.Cartesian3,S=new q.Cartesian3,U=new T.Matrix3,V={unitary:new T.Matrix3,diagonal:new T.Matrix3};v.fromPoints=function(a,t){if(X.defined(t)||(t=new v),!X.defined(a)||0===a.length)return t.halfAxes=T.Matrix3.ZERO,t.center=q.Cartesian3.ZERO,t;for(var e=a.length,n=q.Cartesian3.clone(a[0],R),r=1;r<e;r++)q.Cartesian3.add(n,a[r],n);var i=1/e;q.Cartesian3.multiplyByScalar(n,i,n);var s,o=0,C=0,c=0,u=0,l=0,d=0;for(r=0;r<e;r++)o+=(s=q.Cartesian3.subtract(a[r],n,I)).x*s.x,C+=s.x*s.y,c+=s.x*s.z,u+=s.y*s.y,l+=s.y*s.z,d+=s.z*s.z;o*=i,C*=i,c*=i,u*=i,l*=i,d*=i;var h=U;h[0]=o,h[1]=C,h[2]=c,h[3]=C,h[4]=u,h[5]=l,h[6]=c,h[7]=l,h[8]=d;var x=T.Matrix3.computeEigenDecomposition(h,V),M=T.Matrix3.clone(x.unitary,t.halfAxes),m=T.Matrix3.getColumn(M,0,L),f=T.Matrix3.getColumn(M,1,z),p=T.Matrix3.getColumn(M,2,S),g=-Number.MAX_VALUE,w=-Number.MAX_VALUE,y=-Number.MAX_VALUE,b=Number.MAX_VALUE,O=Number.MAX_VALUE,P=Number.MAX_VALUE;for(r=0;r<e;r++)s=a[r],g=Math.max(q.Cartesian3.dot(m,s),g),w=Math.max(q.Cartesian3.dot(f,s),w),y=Math.max(q.Cartesian3.dot(p,s),y),b=Math.min(q.Cartesian3.dot(m,s),b),O=Math.min(q.Cartesian3.dot(f,s),O),P=Math.min(q.Cartesian3.dot(p,s),P);m=q.Cartesian3.multiplyByScalar(m,.5*(b+g),m),f=q.Cartesian3.multiplyByScalar(f,.5*(O+w),f),p=q.Cartesian3.multiplyByScalar(p,.5*(P+y),p);var N=q.Cartesian3.add(m,f,t.center);q.Cartesian3.add(N,p,N);var A=E;return A.x=g-b,A.y=w-O,A.z=y-P,q.Cartesian3.multiplyByScalar(A,.5,A),T.Matrix3.multiplyByScale(t.halfAxes,A,t.halfAxes),t};var M=new q.Cartesian3,m=new q.Cartesian3;function F(a,t,e,n,r,i,s,o,C,c,u){X.defined(u)||(u=new v);var l=u.halfAxes;T.Matrix3.setColumn(l,0,t,l),T.Matrix3.setColumn(l,1,e,l),T.Matrix3.setColumn(l,2,n,l),(x=M).x=(r+i)/2,x.y=(s+o)/2,x.z=(C+c)/2;var d=m;d.x=(i-r)/2,d.y=(o-s)/2,d.z=(c-C)/2;var h=u.center,x=T.Matrix3.multiplyByVector(l,x,x);return q.Cartesian3.add(a,x,h),T.Matrix3.multiplyByScale(l,d,l),u}var Y=new q.Cartographic,H=new q.Cartesian3,J=new q.Cartographic,K=new q.Cartographic,Q=new q.Cartographic,$=new q.Cartographic,aa=new q.Cartographic,ta=new q.Cartesian3,ea=new q.Cartesian3,na=new q.Cartesian3,ra=new q.Cartesian3,ia=new q.Cartesian3,sa=new q.Cartesian2,oa=new q.Cartesian2,Ca=new q.Cartesian2,ca=new q.Cartesian2,ua=new q.Cartesian2,la=new q.Cartesian3,da=new q.Cartesian3,ha=new q.Cartesian3,xa=new q.Cartesian3,Ma=new q.Cartesian2,ma=new q.Cartesian3,fa=new q.Cartesian3,pa=new q.Cartesian3,ga=new G.Plane(q.Cartesian3.UNIT_X,0);v.fromRectangle=function(a,t,e,n,r){if(t=X.defaultValue(t,0),e=X.defaultValue(e,0),n=X.defaultValue(n,q.Ellipsoid.WGS84),a.width<=Z.CesiumMath.PI){var i,s=q.Rectangle.center(a,Y),o=n.cartographicToCartesian(s,H),C=new j.EllipsoidTangentPlane(o,n),c=C.plane,u=s.longitude,l=a.south<0&&0<a.north?0:s.latitude,d=q.Cartographic.fromRadians(u,a.north,e,J),h=q.Cartographic.fromRadians(a.west,a.north,e,K),x=q.Cartographic.fromRadians(a.west,l,e,Q),M=q.Cartographic.fromRadians(a.west,a.south,e,$),m=q.Cartographic.fromRadians(u,a.south,e,aa),f=n.cartographicToCartesian(d,ta),p=n.cartographicToCartesian(h,ea),g=n.cartographicToCartesian(x,na),w=n.cartographicToCartesian(M,ra),y=n.cartographicToCartesian(m,ia),b=C.projectPointToNearestOnPlane(f,sa),O=C.projectPointToNearestOnPlane(p,oa),P=C.projectPointToNearestOnPlane(g,Ca),N=C.projectPointToNearestOnPlane(w,ca),A=C.projectPointToNearestOnPlane(y,ua),T=-(i=Math.min(O.x,P.x,N.x)),v=Math.max(O.y,b.y),R=Math.min(N.y,A.y);return h.height=M.height=t,p=n.cartographicToCartesian(h,ea),w=n.cartographicToCartesian(M,ra),k=Math.min(G.Plane.getPointDistance(c,p),G.Plane.getPointDistance(c,w)),W=e,F(C.origin,C.xAxis,C.yAxis,C.zAxis,i,T,R,v,k,W,r)}var I=0<a.south,E=a.north<0,L=I?a.south:E?a.north:0,z=q.Rectangle.center(a,Y).longitude,S=q.Cartesian3.fromRadians(z,L,e,n,la);S.z=0;var U=Math.abs(S.x)<Z.CesiumMath.EPSILON10&&Math.abs(S.y)<Z.CesiumMath.EPSILON10?q.Cartesian3.UNIT_X:q.Cartesian3.normalize(S,da),V=q.Cartesian3.UNIT_Z,B=q.Cartesian3.cross(U,V,ha);c=G.Plane.fromPointNormal(S,U,ga);var _=q.Cartesian3.fromRadians(z+Z.CesiumMath.PI_OVER_TWO,L,e,n,xa);i=-(T=q.Cartesian3.dot(G.Plane.projectPointOntoPlane(c,_,Ma),B)),v=q.Cartesian3.fromRadians(0,a.north,E?t:e,n,ma).z,R=q.Cartesian3.fromRadians(0,a.south,I?t:e,n,fa).z;var k,W,D=q.Cartesian3.fromRadians(a.east,L,e,n,pa);return F(S,B,V,U,i,T,R,v,k=G.Plane.getPointDistance(c,D),W=0,r)},v.clone=function(a,t){if(X.defined(a))return X.defined(t)?(q.Cartesian3.clone(a.center,t.center),T.Matrix3.clone(a.halfAxes,t.halfAxes),t):new v(a.center,a.halfAxes)},v.intersectPlane=function(a,t){var e=a.center,n=t.normal,r=a.halfAxes,i=n.x,s=n.y,o=n.z,C=Math.abs(i*r[T.Matrix3.COLUMN0ROW0]+s*r[T.Matrix3.COLUMN0ROW1]+o*r[T.Matrix3.COLUMN0ROW2])+Math.abs(i*r[T.Matrix3.COLUMN1ROW0]+s*r[T.Matrix3.COLUMN1ROW1]+o*r[T.Matrix3.COLUMN1ROW2])+Math.abs(i*r[T.Matrix3.COLUMN2ROW0]+s*r[T.Matrix3.COLUMN2ROW1]+o*r[T.Matrix3.COLUMN2ROW2]),c=q.Cartesian3.dot(n,e)+t.distance;return c<=-C?T.Intersect.OUTSIDE:C<=c?T.Intersect.INSIDE:T.Intersect.INTERSECTING};var x=new q.Cartesian3,f=new q.Cartesian3,p=new q.Cartesian3,h=new q.Cartesian3;v.distanceSquaredTo=function(a,t){var e=q.Cartesian3.subtract(t,a.center,M),n=a.halfAxes,r=T.Matrix3.getColumn(n,0,x),i=T.Matrix3.getColumn(n,1,f),s=T.Matrix3.getColumn(n,2,p),o=q.Cartesian3.magnitude(r),C=q.Cartesian3.magnitude(i),c=q.Cartesian3.magnitude(s);q.Cartesian3.normalize(r,r),q.Cartesian3.normalize(i,i),q.Cartesian3.normalize(s,s);var u=h;u.x=q.Cartesian3.dot(e,r),u.y=q.Cartesian3.dot(e,i),u.z=q.Cartesian3.dot(e,s);var l,d=0;return u.x<-o?d+=(l=u.x+o)*l:u.x>o&&(d+=(l=u.x-o)*l),u.y<-C?d+=(l=u.y+C)*l:u.y>C&&(d+=(l=u.y-C)*l),u.z<-c?d+=(l=u.z+c)*l:u.z>c&&(d+=(l=u.z-c)*l),d};var g=new q.Cartesian3,w=new q.Cartesian3;v.computePlaneDistances=function(a,t,e,n){X.defined(n)||(n=new T.Interval);var r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=a.center,o=a.halfAxes,C=T.Matrix3.getColumn(o,0,x),c=T.Matrix3.getColumn(o,1,f),u=T.Matrix3.getColumn(o,2,p),l=q.Cartesian3.add(C,c,g);q.Cartesian3.add(l,u,l),q.Cartesian3.add(l,s,l);var d=q.Cartesian3.subtract(l,t,w),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i);return q.Cartesian3.add(s,C,l),q.Cartesian3.add(l,c,l),q.Cartesian3.subtract(l,u,l),q.Cartesian3.subtract(l,t,d),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i),q.Cartesian3.add(s,C,l),q.Cartesian3.subtract(l,c,l),q.Cartesian3.add(l,u,l),q.Cartesian3.subtract(l,t,d),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i),q.Cartesian3.add(s,C,l),q.Cartesian3.subtract(l,c,l),q.Cartesian3.subtract(l,u,l),q.Cartesian3.subtract(l,t,d),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i),q.Cartesian3.subtract(s,C,l),q.Cartesian3.add(l,c,l),q.Cartesian3.add(l,u,l),q.Cartesian3.subtract(l,t,d),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i),q.Cartesian3.subtract(s,C,l),q.Cartesian3.add(l,c,l),q.Cartesian3.subtract(l,u,l),q.Cartesian3.subtract(l,t,d),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i),q.Cartesian3.subtract(s,C,l),q.Cartesian3.subtract(l,c,l),q.Cartesian3.add(l,u,l),q.Cartesian3.subtract(l,t,d),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i),q.Cartesian3.subtract(s,C,l),q.Cartesian3.subtract(l,c,l),q.Cartesian3.subtract(l,u,l),q.Cartesian3.subtract(l,t,d),h=q.Cartesian3.dot(e,d),r=Math.min(h,r),i=Math.max(h,i),n.start=r,n.stop=i,n};var n=new T.BoundingSphere;v.isOccluded=function(a,t){var e=T.BoundingSphere.fromOrientedBoundingBox(a,n);return!t.isBoundingSphereVisible(e)},v.prototype.intersectPlane=function(a){return v.intersectPlane(this,a)},v.prototype.distanceSquaredTo=function(a){return v.distanceSquaredTo(this,a)},v.prototype.computePlaneDistances=function(a,t,e){return v.computePlaneDistances(this,a,t,e)},v.prototype.isOccluded=function(a){return v.isOccluded(this,a)},v.equals=function(a,t){return a===t||X.defined(a)&&X.defined(t)&&q.Cartesian3.equals(a.center,t.center)&&T.Matrix3.equals(a.halfAxes,t.halfAxes)},v.prototype.clone=function(a){return v.clone(this,a)},v.prototype.equals=function(a){return v.equals(this,a)},a.OrientedBoundingBox=v});
